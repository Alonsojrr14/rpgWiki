const timelineSections = [
    {
        title: 'üåë Cria√ß√£o do Mundo e dos Deuses',
        events: [
            ["Antes do tempo:", "No in√≠cio, tudo era o nada. Surge Desty, deusa do destino e do tempo, que re√∫ne o pante√£o."],
            ["Antes do tempo:", "Tyri√´r, deusa da terra, molda o mundo e cria os animais."],
            ["Antes do tempo:", "Laxus, deus dos c√©us, cria os ventos, tempestades e o firmamento."],
            ["Antes do tempo:", "Kyrion, deus dos mares, cria os oceanos e as √°guas do mundo."],
            ["Antes do tempo:", "Solaris, deus do sol, traz a luz, o dia e a vida."],
            ["Antes do tempo:", "Serenity, deusa da lua, traz a noite, o repouso e os segredos."],
            ["Antes do tempo:", "Rowan, deus da guerra, traz o conflito e o progresso."],
            ["Antes do tempo:", "Bessemer, deus da forja, cria armas e ferramentas."],
            ["Antes do tempo:", "Wisz, deusa da sabedoria, guia a justi√ßa e a estrat√©gia."],
            ["Antes do tempo:", "Verus, deus mensageiro, garante a verdade e os contratos."],
            ["Antes do tempo:", "Pahrs, deusa da festa, inspira o amor e a celebra√ß√£o."],
            ["Antes do tempo:", "√ñrm, deusa do submundo, guarda o ciclo da vida e da morte."],
            ["Antes do tempo:", "O pante√£o √© formado. Desty orienta os deuses a moldarem o destino do mundo."]
        ]
    },
    {
        title: 'üåë Antes da Era Comum (EC)',
        events: [
            ["-1200 EC", "Nascimento dos Viajantes ‚Äî Ramo dissidente dos bruxos. Desenvolvem a magia do viajante."],
            ["-950 EC", "Nascimento de Sebastian, Kaila e Ananya ‚Äî Tri√¢ngulo amoroso entre um Viajante (Sebastian), sua noiva poderosa (Kaila) e a bruxa da magia animal (Ananya)."],
            ["-915 EC", "Feiti√ßo da Imortalidade ‚Äî Kaila cria o feiti√ßo. Sebastian e Ananya consomem a Ma√ß√£ da Imortalidade secretamente."],
            ["-913 EC", "Trai√ß√£o Descoberta ‚Äî Kaila petrifica Ananya e aprisiona sua ess√™ncia no Cristal Vermelho. Sebastian √© preso em Moon Island."],
            ["-910 EC", "Maldi√ß√£o dos Viajantes ‚Äî Bruxas amaldi√ßoam os Viajantes. Nascem as t√©cnicas de passageiros e a magia do sofrimento."],
            ["-870 EC", "Primeira visita ao Cristal Vermelho ‚Äî Descoberta do poder do sofrimento como √¢ncora."]
        ]
    },
    {
        title: 'üß± Nascimento dos Cristais de Montehara',
        events: [
            ["0 EC", "Montehara se forma ‚Äî Cristal Vermelho cresce sob uma montanha. Outros cristais surgem: Roxo (mente), Azul (necromancia), Cinza (√°gua), Preto (vida)."]
        ]
    },
    {
        title: '‚öîÔ∏è A Guerra Esquecida (1650‚Äì1652 EC)',
        events: [
            ["1650 EC", "Come√ßo da Guerra ‚Äî O pr√≠ncipe Edward sequestra Khaleesi. Inicia-se uma guerra de grandes propor√ß√µes. Diversos guerreiros come√ßam suas jornadas e miss√µes, marcando o in√≠cio de uma era sombria."],
            ["1652 EC", "Final da Guerra ‚Äî A guerra culmina em uma batalha final devastadora. Nela, morrem: Arthur, a rainha, Adalind, Melinda e Ishtar. O mago Merlin se sacrifica para apagar a mem√≥ria de todos, exceto dos guerreiros sobreviventes. O Parlamento √© criado, representando uma tentativa de reconstru√ß√£o e organiza√ß√£o pol√≠tica ap√≥s o caos."]
        ]
    },
    {
        title: 'üëë Era do Reinado Perdido',
        events: [
            ["1660 EC", "Khaleesi completa 20 anos ‚Äî Khaleesi atinge a idade necess√°ria para se tornar rainha. No entanto, ela recusa o trono e parte em uma viagem misteriosa, deixando Surass."],
            ["1671 EC", "Arthur II ‚Äî Khaleesi retorna inesperadamente, carregando um beb√™. Ela afirma que √© seu filho, o filho de um rei, mas n√£o revela o pai. Khaleesi deixa o beb√™ em Surass para ser criado e cuidado pelo Parlamento. A crian√ßa √© chamada de Arthur II."],
            ["1691 EC", "Coroa√ß√£o de Arthur II ‚Äî Arthur II √© coroado rei. Sob seu reinado, Surass √© reconstru√≠da, deixando de ser apenas uma cidade portu√°ria. A cidade se transforma em uma pot√™ncia exportadora gra√ßas a um min√©rio raro que s√≥ ela possui."],
            ["1702 EC", "Diana ‚Äî Arthur II se apaixona por uma plebeia chamada Diana. Eles se casam no mesmo ano, desafiando tradi√ß√µes e fortalecendo os la√ßos entre a nobreza e o povo."],
            ["1706 EC", "Nasce Ezequiel ‚Äî Ap√≥s alguns anos de casamento, Arthur II e Diana t√™m um filho: Ezequiel. Ele √© criado como herdeiro e s√≠mbolo de esperan√ßa para o novo reino."],
            ["1733 EC", "Assassinato ‚Äî Ezequiel, j√° adolescente, acorda uma noite e encontra seus pais mortos ao lado de sua cama. Esse evento traum√°tico marca uma nova virada na hist√≥ria do reino e na vida de Ezequiel."],
            ["1736 EC", "O mundo vive sob as consequ√™ncias do assassinato de Arthur II e Diana. Ezequiel agora √© uma figura central, com um passado marcado por trag√©dia."]
        ]
    },
    {
        title: '‚ú® Era da Reden√ß√£o (1736‚Äì1739 EC)',
        events: [
            ["1736 EC", "A Nova Gera√ß√£o Desperta ‚Äî Lorian, Marceline, Ezio, Helinoor, Lathliss, Garruck. Investigam a Guerra Esquecida, cristais, viajantes e duplicatas."],
            ["1736‚Äì1739 EC", "Escolta com Norki, que revela mais sobre sua liga√ß√£o com Edward e ativa suas antigas cria√ß√µes como o gorila mec√¢nico e os hipogrifos."],
            ["1736‚Äì1737 EC", "Revela√ß√µes sobre a lan√ßa de Solaris (Chastifol) e seu v√≠nculo com Helinoor. A profecia decifrada cont√©m pistas sobre as shinjus. Encontro com Norki e miss√µes em Surass."],
            ["1737‚Äì1738 EC", "Explora√ß√£o da mina em Koryng. Enfrentam orcs escravizando crian√ßas. Descobrem cartas enigm√°ticas de 'Z'. Conhecem Adalind Evans II, que revela ser neta da lend√°ria guerreira Ada."],
            ["1736‚Äì1739 EC", "Zoe reaparece e auxilia com uma chave m√°gica e instru√ß√µes enigm√°ticas para o grupo decifrar."],
            ["1736‚Äì1739 EC", "Explora√ß√£o da dungeon das moedas guiados por uma coruja m√°gica, revelando artefatos raros."],
            ["1736‚Äì1739 EC", "Grupo visita Vaxtz durante o Festival da Colheita e conhece o rei Thadeus Foster."],
            ["1736‚Äì1739 EC", "Descoberta de experimentos envolvendo 'licantropos artificiais', revelando segredos do vilarejo onde Jader (Irm√£o de Janna, um dos licantropos rato) foi morto."],
            ["1738 EC", "Entrada em Montehara e contato com o reino secreto dos an√µes. Vis√£o de Tyrier para Garruck. Alian√ßa entre os protagonistas e Garruck. Encontro com criaturas e obten√ß√£o de novas shinjus."],
            ["1736‚Äì1739 EC", "Jornada ao reino de Garruck, um dom√≠nio an√£o escondido em Montehara. Garruck revela segredos sobre as Shinjus."],
            ["1736‚Äì1739 EC", "Investiga√ß√£o do desaparecimento de crian√ßas em uma vila e confronto com homens-rato em uma base subterr√¢nea."],
            ["1736‚Äì1739 EC", "Primeiro contato com um gnoll chamado Shenzi, que pede ajuda para libertar seu irm√£o prisioneiro de Varok Dranosh. (Rei Orc de Haubergeon)"],
            ["1736‚Äì1739 EC", "Conquista da shinjus de urso"],
            ["1736‚Äì1739 EC", "Timonthe se junta ao grupo depois de jogar uma partida de Formas e cores com o grupo em uma taverna de Erebor."],
            ["1738‚Äì1739 EC", "Aventura em Erebor. Holgar Korgul (irm√£o g√™meo) revela ser oposi√ß√£o a Haubergeon. Batalha contra Helinoor transformada em lobisomem. Batalha a√©rea contra o Diabo dos Espinhos."],
            ["1736‚Äì1739 EC", "Helinoor perde o controle no litoral onde eles est√£o descansando e vira lobisomem; √© curada por Solaris em um evento celestial."],
            ["1736‚Äì1739 EC", "Batalha a√©rea contra o Diabo dos Espinhos durante travessia a√©rea entre regi√µes do continente."],
            ["1739 EC", "Miss√£o investigativa em Eddimos. Descoberta sobre os portais antigos relacionados √† profecia. Intera√ß√µes com Solaris, vis√µes dos deuses e evolu√ß√£o de poderes dos protagonistas."],
            ["1736‚Äì1739 EC", "Recupera√ß√£o da segunda parte da profecia escondida sobre Khaleesi, a pedido do rei de Surass."],
            ["1736‚Äì1739 EC", "Intera√ß√£o com Sauron, que envia mensagem urgente para Erebor e deixa o grupo em miss√£o independente."],
            ["1736‚Äì1739 EC", "Grupo se encontra com Olivia, que revela novas pistas e a amea√ßa crescente de Edward."],
            ["1736‚Äì1739 EC", "Rituais e sonhos prof√©ticos conectam Marceline, Ezio e outros ao plano de fundo da guerra."],
            ["1736‚Äì1739 EC", "Revela√ß√µes sobre faeria, profecias das ra√ßas, e amea√ßas ao equil√≠brio m√°gico."]
        ]
    },
    {
        title: 'üåë Saga das Duplicatas (Campanha Atual ‚Äì 1740 EC)',
        events: [
            ["1740 EC", "Campanha Atual ‚Äì Sess√µes 1 a 8 ‚Äî Endrick, Khrogan, Emma, Rudy, James, Alain."],
            ["1740 EC", "Principais eventos ‚Äî Vis√µes do passado, Cristal da Vida, conflitos com viajantes, mem√≥rias emergem, Parlamento interfere, monstros petrificados."],
            ["1739‚Äì1740 EC", "Confronto em Surass contra seita de transmutadores. Assassinato misterioso investigado. Descoberta de rituais envolvendo transmuta√ß√£o for√ßada de humanos."],
            ["1740 EC", "Entrada no castelo com Holkar. Encontro com Olivia e Zoe. Confronto com Edward em outro plano. Sacrif√≠cio ilus√≥rio de Olivia. Edward acredita ter vencido. Realidade moldada. Aparece Lorian, abre o Caminho."],
            ["1740 EC", "Vis√µes de Marceline e Ezio revelam pactos divinos com entidades elementares (√°gua e eletricidade). Revela√ß√µes sobre as experi√™ncias com licantropos e origem de Jader e Janna."],
            ["1740 EC", "Resgate de Marco. Encontro com Adalind Evans II. Viagem pelas montanhas de Montehara. Visita a vilas como Elbrus e Koryng. Dungeon de Carlisle Al-Ghul."],
            ["1740 EC", "Prel√∫dio da Crise Multiversal. Lorian abre portal ps√≠quico com auroras. Vis√µes e revela√ß√µes de que as a√ß√µes at√© agora foram tentativas de impedir o Ragnarok. √öltima chance para impedir o colapso total do multiverso."]
        ]
    }
];

function createModal() {
    // Cria o modal e adiciona ao body (s√≥ uma vez)
    if (document.getElementById('modal-bg')) return;
    const modalBg = document.createElement('div');
    modalBg.className = 'modal-bg';
    modalBg.id = 'modal-bg';
    modalBg.innerHTML = `
        <div class="modal" tabindex="-1">
            <button class="modal-close" id="modal-close" title="Fechar">√ó</button>
            <div class="modal-title" id="modal-title"></div>
            <ul class="modal-events" id="modal-events"></ul>
        </div>
    `;
    document.body.appendChild(modalBg);

    // Fechar ao clicar no fundo
    modalBg.addEventListener('click', (e) => {
        if (e.target === modalBg) hideModal();
    });
    // Fechar ao clicar no X
    document.getElementById('modal-close').onclick = hideModal;
    // Fechar com ESC
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') hideModal();
    });
}

function showModal(section) {
    createModal();
    document.getElementById('modal-title').textContent = section.title;
    const ul = document.getElementById('modal-events');
    ul.innerHTML = '';
    section.events.forEach(([date, desc]) => {
        const li = document.createElement('li');
        li.className = 'modal-event';
        li.innerHTML = `<span class="event-date">${date}</span><span class="event-desc">${desc}</span>`;
        ul.appendChild(li);
    });
    document.getElementById('modal-bg').classList.add('active');
    document.querySelector('.modal').focus();
}

function hideModal() {
    const modalBg = document.getElementById('modal-bg');
    if (modalBg) modalBg.classList.remove('active');
}

function addBlock(section) {
    const block = document.createElement('div');
    block.className = 'timeline-block';
    block.tabIndex = 0;
    block.textContent = section.title;
    block.onclick = () => showModal(section);
    block.onkeydown = (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            showModal(section);
        }
    };
    document.getElementById('timeline').appendChild(block);
}

window.onload = function() {
    timelineSections.forEach(sec => addBlock(sec));
}; 